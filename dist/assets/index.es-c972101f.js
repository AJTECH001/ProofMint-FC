import{f as v,r as le,h as de,i as pe}from"./index-525d8d72.js";const ye=t=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+"n":s),be=t=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,s=t.replace(r,'$1"$2n"$3');return JSON.parse(s,(u,h)=>typeof h=="string"&&h.match(/^\d+n$/)?BigInt(h.substring(0,h.length-1)):h)};function ge(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return be(t)}catch{return t}}function N(t){return typeof t=="string"?t:ye(t)||""}const ve="PARSE_ERROR",me="INVALID_REQUEST",we="METHOD_NOT_FOUND",Ee="INVALID_PARAMS",Q="INTERNAL_ERROR",S="SERVER_ERROR",Re=[-32700,-32600,-32601,-32602,-32603],A={[ve]:{code:-32700,message:"Parse error"},[me]:{code:-32600,message:"Invalid Request"},[we]:{code:-32601,message:"Method not found"},[Ee]:{code:-32602,message:"Invalid params"},[Q]:{code:-32603,message:"Internal error"},[S]:{code:-32e3,message:"Server error"}},W=S;function _e(t){return Re.includes(t)}function L(t){return Object.keys(A).includes(t)?A[t]:A[W]}function Ae(t){const r=Object.values(A).find(s=>s.code===t);return r||A[W]}function Oe(t,r,s){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${s} RPC url at ${r}`):t}var Te={},m={},H;function Pe(){if(H)return m;H=1,Object.defineProperty(m,"__esModule",{value:!0}),m.isBrowserCryptoAvailable=m.getSubtleCrypto=m.getBrowerCrypto=void 0;function t(){return(v===null||v===void 0?void 0:v.crypto)||(v===null||v===void 0?void 0:v.msCrypto)||{}}m.getBrowerCrypto=t;function r(){const u=t();return u.subtle||u.webkitSubtle}m.getSubtleCrypto=r;function s(){return!!t()&&!!r()}return m.isBrowserCryptoAvailable=s,m}var w={},F;function Be(){if(F)return w;F=1,Object.defineProperty(w,"__esModule",{value:!0}),w.isBrowser=w.isNode=w.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}w.isReactNative=t;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}w.isNode=r;function s(){return!t()&&!r()}return w.isBrowser=s,w}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const r=le;r.__exportStar(Pe(),t),r.__exportStar(Be(),t)})(Te);function Z(t=3){const r=Date.now()*Math.pow(10,t),s=Math.floor(Math.random()*Math.pow(10,t));return r+s}function Ge(t=6){return BigInt(Z(t))}function ze(t,r,s){return{id:s||Z(),jsonrpc:"2.0",method:t,params:r}}function Xe(t,r){return{id:t,jsonrpc:"2.0",result:r}}function De(t,r,s){return{id:t,jsonrpc:"2.0",error:xe(r,s)}}function xe(t,r){return typeof t>"u"?L(Q):(typeof t=="string"&&(t=Object.assign(Object.assign({},L(S)),{message:t})),typeof r<"u"&&(t.data=r),_e(t.code)&&(t=Ae(t.code)),t)}class K{}let Qe=class extends K{constructor(r){super()}};class je extends K{constructor(){super()}}class Ze extends je{constructor(r){super()}}const Se="^https?:",Ce="^wss?:";function Ue(t){const r=t.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function Y(t,r){const s=Ue(t);return typeof s>"u"?!1:new RegExp(r).test(s)}function q(t){return Y(t,Se)}function Ke(t){return Y(t,Ce)}function Ye(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function ee(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function et(t){return ee(t)&&"method"in t}function tt(t){return ee(t)&&(Ie(t)||Me(t))}function Ie(t){return"result"in t}function Me(t){return"error"in t}var j={exports:{}};(function(t,r){var s=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof v<"u"&&v,u=function(){function g(){this.fetch=!1,this.DOMException=s.DOMException}return g.prototype=s,new g}();(function(g){(function(y){var l=typeof g<"u"&&g||typeof self<"u"&&self||typeof v<"u"&&v||{},p={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function te(e){return e&&DataView.prototype.isPrototypeOf(e)}if(p.arrayBuffer)var re=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],ne=ArrayBuffer.isView||function(e){return e&&re.indexOf(Object.prototype.toString.call(e))>-1};function _(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function T(e){return typeof e!="string"&&(e=String(e)),e}function P(e){var n={next:function(){var o=e.shift();return{done:o===void 0,value:o}}};return p.iterable&&(n[Symbol.iterator]=function(){return n}),n}function c(e){this.map={},e instanceof c?e.forEach(function(n,o){this.append(o,n)},this):Array.isArray(e)?e.forEach(function(n){if(n.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+n.length);this.append(n[0],n[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(n){this.append(n,e[n])},this)}c.prototype.append=function(e,n){e=_(e),n=T(n);var o=this.map[e];this.map[e]=o?o+", "+n:n},c.prototype.delete=function(e){delete this.map[_(e)]},c.prototype.get=function(e){return e=_(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(_(e))},c.prototype.set=function(e,n){this.map[_(e)]=T(n)},c.prototype.forEach=function(e,n){for(var o in this.map)this.map.hasOwnProperty(o)&&e.call(n,this.map[o],o,this)},c.prototype.keys=function(){var e=[];return this.forEach(function(n,o){e.push(o)}),P(e)},c.prototype.values=function(){var e=[];return this.forEach(function(n){e.push(n)}),P(e)},c.prototype.entries=function(){var e=[];return this.forEach(function(n,o){e.push([o,n])}),P(e)},p.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);function B(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function C(e){return new Promise(function(n,o){e.onload=function(){n(e.result)},e.onerror=function(){o(e.error)}})}function se(e){var n=new FileReader,o=C(n);return n.readAsArrayBuffer(e),o}function oe(e){var n=new FileReader,o=C(n),a=/charset=([A-Za-z0-9_-]+)/.exec(e.type),f=a?a[1]:"utf-8";return n.readAsText(e,f),o}function ie(e){for(var n=new Uint8Array(e),o=new Array(n.length),a=0;a<n.length;a++)o[a]=String.fromCharCode(n[a]);return o.join("")}function U(e){if(e.slice)return e.slice(0);var n=new Uint8Array(e.byteLength);return n.set(new Uint8Array(e)),n.buffer}function I(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:p.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:p.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():p.arrayBuffer&&p.blob&&te(e)?(this._bodyArrayBuffer=U(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||ne(e))?this._bodyArrayBuffer=U(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var e=B(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=B(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(p.blob)return this.blob().then(se);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var e=B(this);if(e)return e;if(this._bodyBlob)return oe(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ie(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(ce)}),this.json=function(){return this.text().then(JSON.parse)},this}var ae=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function fe(e){var n=e.toUpperCase();return ae.indexOf(n)>-1?n:e}function E(e,n){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');n=n||{};var o=n.body;if(e instanceof E){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,n.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!o&&e._bodyInit!=null&&(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=n.credentials||this.credentials||"same-origin",(n.headers||!this.headers)&&(this.headers=new c(n.headers)),this.method=fe(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal||function(){if("AbortController"in l){var i=new AbortController;return i.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),(this.method==="GET"||this.method==="HEAD")&&(n.cache==="no-store"||n.cache==="no-cache")){var a=/([?&])_=[^&]*/;if(a.test(this.url))this.url=this.url.replace(a,"$1_="+new Date().getTime());else{var f=/\?/;this.url+=(f.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})};function ce(e){var n=new FormData;return e.trim().split("&").forEach(function(o){if(o){var a=o.split("="),f=a.shift().replace(/\+/g," "),i=a.join("=").replace(/\+/g," ");n.append(decodeURIComponent(f),decodeURIComponent(i))}}),n}function ue(e){var n=new c,o=e.replace(/\r?\n[\t ]+/g," ");return o.split("\r").map(function(a){return a.indexOf(`
`)===0?a.substr(1,a.length):a}).forEach(function(a){var f=a.split(":"),i=f.shift().trim();if(i){var O=f.join(":").trim();try{n.append(i,O)}catch(x){console.warn("Response "+x.message)}}}),n}I.call(E.prototype);function b(e,n){if(!(this instanceof b))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(n||(n={}),this.type="default",this.status=n.status===void 0?200:n.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=n.statusText===void 0?"":""+n.statusText,this.headers=new c(n.headers),this.url=n.url||"",this._initBody(e)}I.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},b.error=function(){var e=new b(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var he=[301,302,303,307,308];b.redirect=function(e,n){if(he.indexOf(n)===-1)throw new RangeError("Invalid status code");return new b(null,{status:n,headers:{location:e}})},y.DOMException=l.DOMException;try{new y.DOMException}catch{y.DOMException=function(n,o){this.message=n,this.name=o;var a=Error(n);this.stack=a.stack},y.DOMException.prototype=Object.create(Error.prototype),y.DOMException.prototype.constructor=y.DOMException}function D(e,n){return new Promise(function(o,a){var f=new E(e,n);if(f.signal&&f.signal.aborted)return a(new y.DOMException("Aborted","AbortError"));var i=new XMLHttpRequest;function O(){i.abort()}i.onload=function(){var d={statusText:i.statusText,headers:ue(i.getAllResponseHeaders()||"")};f.url.indexOf("file://")===0&&(i.status<200||i.status>599)?d.status=200:d.status=i.status,d.url="responseURL"in i?i.responseURL:d.headers.get("X-Request-URL");var R="response"in i?i.response:i.responseText;setTimeout(function(){o(new b(R,d))},0)},i.onerror=function(){setTimeout(function(){a(new TypeError("Network request failed"))},0)},i.ontimeout=function(){setTimeout(function(){a(new TypeError("Network request timed out"))},0)},i.onabort=function(){setTimeout(function(){a(new y.DOMException("Aborted","AbortError"))},0)};function x(d){try{return d===""&&l.location.href?l.location.href:d}catch{return d}}if(i.open(f.method,x(f.url),!0),f.credentials==="include"?i.withCredentials=!0:f.credentials==="omit"&&(i.withCredentials=!1),"responseType"in i&&(p.blob?i.responseType="blob":p.arrayBuffer&&(i.responseType="arraybuffer")),n&&typeof n.headers=="object"&&!(n.headers instanceof c||l.Headers&&n.headers instanceof l.Headers)){var M=[];Object.getOwnPropertyNames(n.headers).forEach(function(d){M.push(_(d)),i.setRequestHeader(d,T(n.headers[d]))}),f.headers.forEach(function(d,R){M.indexOf(R)===-1&&i.setRequestHeader(R,d)})}else f.headers.forEach(function(d,R){i.setRequestHeader(R,d)});f.signal&&(f.signal.addEventListener("abort",O),i.onreadystatechange=function(){i.readyState===4&&f.signal.removeEventListener("abort",O)}),i.send(typeof f._bodyInit>"u"?null:f._bodyInit)})}return D.polyfill=!0,l.fetch||(l.fetch=D,l.Headers=c,l.Request=E,l.Response=b),y.Headers=c,y.Request=E,y.Response=b,y.fetch=D,Object.defineProperty(y,"__esModule",{value:!0}),y})({})})(u),u.fetch.ponyfill=!0,delete u.fetch.polyfill;var h=s.fetch?s:u;r=h.fetch,r.default=h.fetch,r.fetch=h.fetch,r.Headers=h.Headers,r.Request=h.Request,r.Response=h.Response,t.exports=r})(j,j.exports);var Ne=j.exports;const J=de(Ne);var Le=Object.defineProperty,He=Object.defineProperties,Fe=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,qe=Object.prototype.hasOwnProperty,Je=Object.prototype.propertyIsEnumerable,V=(t,r,s)=>r in t?Le(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,k=(t,r)=>{for(var s in r||(r={}))qe.call(r,s)&&V(t,s,r[s]);if($)for(var s of $(r))Je.call(r,s)&&V(t,s,r[s]);return t},G=(t,r)=>He(t,Fe(r));const $e={Accept:"application/json","Content-Type":"application/json"},Ve="POST",z={headers:$e,method:Ve},X=10;class rt{constructor(r,s=!1){if(this.url=r,this.disableProviderPing=s,this.events=new pe.EventEmitter,this.isAvailable=!1,this.registering=!1,!q(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=s}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,s){this.events.on(r,s)}once(r,s){this.events.once(r,s)}off(r,s){this.events.off(r,s)}removeListener(r,s){this.events.removeListener(r,s)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r){this.isAvailable||await this.register();try{const s=N(r),u=await(await J(this.url,G(k({},z),{body:s}))).json();this.onPayload({data:u})}catch(s){this.onError(r.id,s)}}async register(r=this.url){if(!q(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const s=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=s||this.events.listenerCount("open")>=s)&&this.events.setMaxListeners(s+1),new Promise((u,h)=>{this.events.once("register_error",g=>{this.resetMaxListeners(),h(g)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return h(new Error("HTTP connection is missing or invalid"));u()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const s=N({id:1,jsonrpc:"2.0",method:"test",params:[]});await J(r,G(k({},z),{body:s}))}this.onOpen()}catch(s){const u=this.parseError(s);throw this.events.emit("register_error",u),this.onClose(),u}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const s=typeof r.data=="string"?ge(r.data):r.data;this.events.emit("payload",s)}onError(r,s){const u=this.parseError(s),h=u.message||u.toString(),g=De(r,h);this.events.emit("payload",g)}parseError(r,s=this.url){return Oe(r,s,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>X&&this.events.setMaxListeners(X)}}export{ge as a,tt as b,Ke as c,Te as d,Ye as e,ze as f,Ge as g,De as h,Me as i,et as j,Xe as k,Ie as l,Z as m,rt as n,Qe as o,Oe as p,Ze as r,N as s};
