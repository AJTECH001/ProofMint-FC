import{e as he}from"./events-f7d8a690.js";import{r as le,f as de}from"./index-0cbb02bb.js";const pe=t=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+"n":s),ye=t=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,s=t.replace(r,'$1"$2n"$3');return JSON.parse(s,(u,h)=>typeof h=="string"&&h.match(/^\d+n$/)?BigInt(h.substring(0,h.length-1)):h)};function be(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return ye(t)}catch{return t}}function M(t){return typeof t=="string"?t:pe(t)||""}const ge="PARSE_ERROR",ve="INVALID_REQUEST",me="METHOD_NOT_FOUND",we="INVALID_PARAMS",X="INTERNAL_ERROR",j="SERVER_ERROR",Ee=[-32700,-32600,-32601,-32602,-32603],_={[ge]:{code:-32700,message:"Parse error"},[ve]:{code:-32600,message:"Invalid Request"},[me]:{code:-32601,message:"Method not found"},[we]:{code:-32602,message:"Invalid params"},[X]:{code:-32603,message:"Internal error"},[j]:{code:-32e3,message:"Server error"}},Q=j;function Re(t){return Ee.includes(t)}function N(t){return Object.keys(_).includes(t)?_[t]:_[Q]}function _e(t){const r=Object.values(_).find(s=>s.code===t);return r||_[Q]}function Ae(t,r,s){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${s} RPC url at ${r}`):t}var Oe={},v={},L;function Te(){if(L)return v;L=1,Object.defineProperty(v,"__esModule",{value:!0}),v.isBrowserCryptoAvailable=v.getSubtleCrypto=v.getBrowerCrypto=void 0;function t(){return(globalThis==null?void 0:globalThis.crypto)||(globalThis==null?void 0:globalThis.msCrypto)||{}}v.getBrowerCrypto=t;function r(){const u=t();return u.subtle||u.webkitSubtle}v.getSubtleCrypto=r;function s(){return!!t()&&!!r()}return v.isBrowserCryptoAvailable=s,v}var m={},H;function Pe(){if(H)return m;H=1,Object.defineProperty(m,"__esModule",{value:!0}),m.isBrowser=m.isNode=m.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}m.isReactNative=t;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}m.isNode=r;function s(){return!t()&&!r()}return m.isBrowser=s,m}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const r=le;r.__exportStar(Te(),t),r.__exportStar(Pe(),t)})(Oe);function W(t=3){const r=Date.now()*Math.pow(10,t),s=Math.floor(Math.random()*Math.pow(10,t));return r+s}function Ge(t=6){return BigInt(W(t))}function ze(t,r,s){return{id:s||W(),jsonrpc:"2.0",method:t,params:r}}function Xe(t,r){return{id:t,jsonrpc:"2.0",result:r}}function Be(t,r,s){return{id:t,jsonrpc:"2.0",error:De(r,s)}}function De(t,r){return typeof t>"u"?N(X):(typeof t=="string"&&(t=Object.assign(Object.assign({},N(j)),{message:t})),typeof r<"u"&&(t.data=r),Re(t.code)&&(t=_e(t.code)),t)}class Z{}let Qe=class extends Z{constructor(r){super()}};class xe extends Z{constructor(){super()}}class Ze extends xe{constructor(r){super()}}const je="^https?:",Se="^wss?:";function Ce(t){const r=t.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function K(t,r){const s=Ce(t);return typeof s>"u"?!1:new RegExp(r).test(s)}function F(t){return K(t,je)}function Ke(t){return K(t,Se)}function Ye(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Y(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function et(t){return Y(t)&&"method"in t}function tt(t){return Y(t)&&(Ue(t)||Ie(t))}function Ue(t){return"result"in t}function Ie(t){return"error"in t}var x={exports:{}};(function(t,r){var s=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof globalThis<"u"&&globalThis,u=function(){function b(){this.fetch=!1,this.DOMException=s.DOMException}return b.prototype=s,new b}();(function(b){(function(y){var l=typeof b<"u"&&b||typeof self<"u"&&self||typeof b<"u"&&b||{},p={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function ee(e){return e&&DataView.prototype.isPrototypeOf(e)}if(p.arrayBuffer)var te=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],re=ArrayBuffer.isView||function(e){return e&&te.indexOf(Object.prototype.toString.call(e))>-1};function R(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function O(e){return typeof e!="string"&&(e=String(e)),e}function T(e){var n={next:function(){var o=e.shift();return{done:o===void 0,value:o}}};return p.iterable&&(n[Symbol.iterator]=function(){return n}),n}function c(e){this.map={},e instanceof c?e.forEach(function(n,o){this.append(o,n)},this):Array.isArray(e)?e.forEach(function(n){if(n.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+n.length);this.append(n[0],n[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(n){this.append(n,e[n])},this)}c.prototype.append=function(e,n){e=R(e),n=O(n);var o=this.map[e];this.map[e]=o?o+", "+n:n},c.prototype.delete=function(e){delete this.map[R(e)]},c.prototype.get=function(e){return e=R(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(R(e))},c.prototype.set=function(e,n){this.map[R(e)]=O(n)},c.prototype.forEach=function(e,n){for(var o in this.map)this.map.hasOwnProperty(o)&&e.call(n,this.map[o],o,this)},c.prototype.keys=function(){var e=[];return this.forEach(function(n,o){e.push(o)}),T(e)},c.prototype.values=function(){var e=[];return this.forEach(function(n){e.push(n)}),T(e)},c.prototype.entries=function(){var e=[];return this.forEach(function(n,o){e.push([o,n])}),T(e)},p.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);function P(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function S(e){return new Promise(function(n,o){e.onload=function(){n(e.result)},e.onerror=function(){o(e.error)}})}function ne(e){var n=new FileReader,o=S(n);return n.readAsArrayBuffer(e),o}function se(e){var n=new FileReader,o=S(n),a=/charset=([A-Za-z0-9_-]+)/.exec(e.type),f=a?a[1]:"utf-8";return n.readAsText(e,f),o}function oe(e){for(var n=new Uint8Array(e),o=new Array(n.length),a=0;a<n.length;a++)o[a]=String.fromCharCode(n[a]);return o.join("")}function C(e){if(e.slice)return e.slice(0);var n=new Uint8Array(e.byteLength);return n.set(new Uint8Array(e)),n.buffer}function U(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:p.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:p.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:p.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():p.arrayBuffer&&p.blob&&ee(e)?(this._bodyArrayBuffer=C(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):p.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||re(e))?this._bodyArrayBuffer=C(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):p.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},p.blob&&(this.blob=function(){var e=P(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=P(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(p.blob)return this.blob().then(ne);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var e=P(this);if(e)return e;if(this._bodyBlob)return se(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(oe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},p.formData&&(this.formData=function(){return this.text().then(fe)}),this.json=function(){return this.text().then(JSON.parse)},this}var ie=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function ae(e){var n=e.toUpperCase();return ie.indexOf(n)>-1?n:e}function w(e,n){if(!(this instanceof w))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');n=n||{};var o=n.body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,n.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!o&&e._bodyInit!=null&&(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=n.credentials||this.credentials||"same-origin",(n.headers||!this.headers)&&(this.headers=new c(n.headers)),this.method=ae(n.method||this.method||"GET"),this.mode=n.mode||this.mode||null,this.signal=n.signal||this.signal||function(){if("AbortController"in l){var i=new AbortController;return i.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&o)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(o),(this.method==="GET"||this.method==="HEAD")&&(n.cache==="no-store"||n.cache==="no-cache")){var a=/([?&])_=[^&]*/;if(a.test(this.url))this.url=this.url.replace(a,"$1_="+new Date().getTime());else{var f=/\?/;this.url+=(f.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})};function fe(e){var n=new FormData;return e.trim().split("&").forEach(function(o){if(o){var a=o.split("="),f=a.shift().replace(/\+/g," "),i=a.join("=").replace(/\+/g," ");n.append(decodeURIComponent(f),decodeURIComponent(i))}}),n}function ce(e){var n=new c,o=e.replace(/\r?\n[\t ]+/g," ");return o.split("\r").map(function(a){return a.indexOf(`
`)===0?a.substr(1,a.length):a}).forEach(function(a){var f=a.split(":"),i=f.shift().trim();if(i){var A=f.join(":").trim();try{n.append(i,A)}catch(D){console.warn("Response "+D.message)}}}),n}U.call(w.prototype);function g(e,n){if(!(this instanceof g))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(n||(n={}),this.type="default",this.status=n.status===void 0?200:n.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=n.statusText===void 0?"":""+n.statusText,this.headers=new c(n.headers),this.url=n.url||"",this._initBody(e)}U.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},g.error=function(){var e=new g(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var ue=[301,302,303,307,308];g.redirect=function(e,n){if(ue.indexOf(n)===-1)throw new RangeError("Invalid status code");return new g(null,{status:n,headers:{location:e}})},y.DOMException=l.DOMException;try{new y.DOMException}catch{y.DOMException=function(n,o){this.message=n,this.name=o;var a=Error(n);this.stack=a.stack},y.DOMException.prototype=Object.create(Error.prototype),y.DOMException.prototype.constructor=y.DOMException}function B(e,n){return new Promise(function(o,a){var f=new w(e,n);if(f.signal&&f.signal.aborted)return a(new y.DOMException("Aborted","AbortError"));var i=new XMLHttpRequest;function A(){i.abort()}i.onload=function(){var d={statusText:i.statusText,headers:ce(i.getAllResponseHeaders()||"")};f.url.indexOf("file://")===0&&(i.status<200||i.status>599)?d.status=200:d.status=i.status,d.url="responseURL"in i?i.responseURL:d.headers.get("X-Request-URL");var E="response"in i?i.response:i.responseText;setTimeout(function(){o(new g(E,d))},0)},i.onerror=function(){setTimeout(function(){a(new TypeError("Network request failed"))},0)},i.ontimeout=function(){setTimeout(function(){a(new TypeError("Network request timed out"))},0)},i.onabort=function(){setTimeout(function(){a(new y.DOMException("Aborted","AbortError"))},0)};function D(d){try{return d===""&&l.location.href?l.location.href:d}catch{return d}}if(i.open(f.method,D(f.url),!0),f.credentials==="include"?i.withCredentials=!0:f.credentials==="omit"&&(i.withCredentials=!1),"responseType"in i&&(p.blob?i.responseType="blob":p.arrayBuffer&&(i.responseType="arraybuffer")),n&&typeof n.headers=="object"&&!(n.headers instanceof c||l.Headers&&n.headers instanceof l.Headers)){var I=[];Object.getOwnPropertyNames(n.headers).forEach(function(d){I.push(R(d)),i.setRequestHeader(d,O(n.headers[d]))}),f.headers.forEach(function(d,E){I.indexOf(E)===-1&&i.setRequestHeader(E,d)})}else f.headers.forEach(function(d,E){i.setRequestHeader(E,d)});f.signal&&(f.signal.addEventListener("abort",A),i.onreadystatechange=function(){i.readyState===4&&f.signal.removeEventListener("abort",A)}),i.send(typeof f._bodyInit>"u"?null:f._bodyInit)})}return B.polyfill=!0,l.fetch||(l.fetch=B,l.Headers=c,l.Request=w,l.Response=g),y.Headers=c,y.Request=w,y.Response=g,y.fetch=B,Object.defineProperty(y,"__esModule",{value:!0}),y})({})})(u),u.fetch.ponyfill=!0,delete u.fetch.polyfill;var h=s.fetch?s:u;r=h.fetch,r.default=h.fetch,r.fetch=h.fetch,r.Headers=h.Headers,r.Request=h.Request,r.Response=h.Response,t.exports=r})(x,x.exports);var Me=x.exports;const q=de(Me);var Ne=Object.defineProperty,Le=Object.defineProperties,He=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertySymbols,Fe=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable,$=(t,r,s)=>r in t?Ne(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,V=(t,r)=>{for(var s in r||(r={}))Fe.call(r,s)&&$(t,s,r[s]);if(J)for(var s of J(r))qe.call(r,s)&&$(t,s,r[s]);return t},k=(t,r)=>Le(t,He(r));const Je={Accept:"application/json","Content-Type":"application/json"},$e="POST",G={headers:Je,method:$e},z=10;class rt{constructor(r,s=!1){if(this.url=r,this.disableProviderPing=s,this.events=new he.EventEmitter,this.isAvailable=!1,this.registering=!1,!F(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=s}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,s){this.events.on(r,s)}once(r,s){this.events.once(r,s)}off(r,s){this.events.off(r,s)}removeListener(r,s){this.events.removeListener(r,s)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r){this.isAvailable||await this.register();try{const s=M(r),u=await(await q(this.url,k(V({},G),{body:s}))).json();this.onPayload({data:u})}catch(s){this.onError(r.id,s)}}async register(r=this.url){if(!F(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const s=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=s||this.events.listenerCount("open")>=s)&&this.events.setMaxListeners(s+1),new Promise((u,h)=>{this.events.once("register_error",b=>{this.resetMaxListeners(),h(b)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return h(new Error("HTTP connection is missing or invalid"));u()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const s=M({id:1,jsonrpc:"2.0",method:"test",params:[]});await q(r,k(V({},G),{body:s}))}this.onOpen()}catch(s){const u=this.parseError(s);throw this.events.emit("register_error",u),this.onClose(),u}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const s=typeof r.data=="string"?be(r.data):r.data;this.events.emit("payload",s)}onError(r,s){const u=this.parseError(s),h=u.message||u.toString(),b=Be(r,h);this.events.emit("payload",b)}parseError(r,s=this.url){return Ae(r,s,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>z&&this.events.setMaxListeners(z)}}export{be as a,tt as b,Ke as c,Oe as d,Ye as e,ze as f,Ge as g,Be as h,Ie as i,et as j,Xe as k,Ue as l,W as m,rt as n,Qe as o,Ae as p,Ze as r,M as s};
